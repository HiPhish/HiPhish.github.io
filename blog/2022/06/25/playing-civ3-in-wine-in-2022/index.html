<!DOCTYPE html>
<html lang="en"><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><title>HiPhish's Workshop</title><link rel="stylesheet" href="/css/main.css" type="text/css" media="all"/><link rel="stylesheet" href="/css/local-nav.css" type="text/css" media="all"/><link rel="stylesheet" href="/css/blog.css" type="text/css" media="all"/></head><body><header><nav id="main-navbar"><input type="checkbox" id="main-nav-hamburger" hidden="hidden"/><div><a href="/">HiPhish's Workshop</a><label for="main-nav-hamburger" hidden="hidden"></label></div><ul><li><a href="/grid-framework/">Grid Framework</a><ul><li><a href="/grid-framework/">Overview</a></li><li hidden="hidden"/><li><a href="/grid-framework/features/">Features</a></li><li><a href="/grid-framework/examples/">Examples</a></li><li><a href="/grid-framework/gallery/">Gallery</a></li><li><a href="/grid-framework/showcase/">Showcase</a></li><li><a href="/grid-framework/faq/">FAQ</a></li><li><a href=" /grid-framework/news/">News</a></li><li hidden="hidden"/><li><a href="http://forum.unity3d.com/threads/grid-framework-scripting-and-editor-plugins.144886/">Support</a></li><li hidden="hidden"/><li><a href="https://www.assetstore.unity3d.com/#/content/62498">Buy Now <span class="badge">35$</span></a></li></ul></li><li><a href="/#products">Open Source</a><ul><li><a href="https://gitlab.com/HiPhish/ntfs-clone">NTFS-Clone</a></li><li><a href="https://gitlab.com/HiPhish/IPS-Tools">IPS-Tools</a></li><li><a href="https://gitlab.com/HiPhish/roll">roll</a></li><li><a href="https://github.com/HiPhish/Newton-method">Newton's Method in C</a></li><li><a href="https://github.com/HiPhish/XeenTools">Xeen Tools</a></li><li><a href="https://github.com/HiPhish/Wolf3DExtract">Wolf3D Extract</a></li><li><a href="https://github.com/HiPhish/Game-Source-Documentation">Game Source Documentation</a></li></ul></li><li><a href="/vim/plugins/">Vim/Nvim plugins</a><ul><li><a href="https://gitlab.com/HiPhish/info.vim">Info.vim</a></li><li><a href="https://gitlab.com/HiPhish/repl.nvim">REPL.nvim</a></li><li><a href="https://gitlab.com/HiPhish/quicklisp.nvim">Quicklisp.nvim</a></li><li><a href="https://gitlab.com/HiPhish/jinja.vim">jinja.vim</a></li><li><a href="https://gitlab.com/HiPhish/neovim-guix-channel/">Guix channel</a></li></ul></li><li class="push-end"><a href="/blog/">Blog</a></li><li><a href="/about/">About</a></li></ul></nav></header><div><div class="blog"><nav class="breadcrumbs" aria-label="Breadcrumbs"><ol><li class=""><a href="../../../../">blog</a></li><li class=""><a href="../../../">2022</a></li><li class=""><a href="../../">06</a></li><li class="active">25</li><li class="active">playing-civ3-in-wine-in-2022</li></ol></nav><main class="blogpost"><article><h1><a href="." title="permalink to Playing Sid Meier's Civilization III in Wine in 2022" rel="bookmark">Playing Sid Meier's Civilization III in Wine in 2022</a></h1><header class="blog-post-header"><p class="blog-post-published">published: <time datetime="2022-06-25">2022-06-25</time></p><p class="blog-post-category">categories: <a href="../../../../categories/misc/">misc</a></p><p class="blog-post-tags">tags: <a href="../../../../tags/wine/">wine</a>, <a href="../../../../tags/games/">games</a></p></header><p>A few days ago I wanted to re-install Sid Meier's Civilization III on my
machine and play it again. This blog post is a summary of the tricks I had to
use to make it work it work well; I am writing it down for posterity, maybe
someone else will find it useful. That someone might even be future me.</p><p>The following was done using the retail releases of the base game and the
Conquests expansion (which includes the Play the World expansion). I expect
readers to already be familiar with <a href="https://www.winehq.org/">Wine</a>; I will only cover the extra steps
needed, this is not a step-by-step guide.</p><p>The following was tested in Wine 7.10, in a 64bit prefix, using X11 on
<a href="https://voidlinux.org/">Void Linux</a>.</p><h2 id="Installation and official patches">Installation and official patches</h2><p>Nothing out of the ordinary here. Install the base game, then install the
expansion (into the same Wine prefix of course). Finally install the correct
official patch for your game.</p><p>To find out which version number you have without launching the game you can
open the relevant README file in a text editor. Starting from the install
directory of the base game there are:</p><ul><li><p><code>README.txt</code> (base game)</p></li><li><p><code>Civ3PTW/readme.txt</code> (Play the World expansion)</p></li><li><p><code>Conquests/readme.txt</code> (Conquests expansion)</p></li></ul><p>In my case the Play the World file did not have any version number, but that
might be because Conquests already includes Play The World.</p><h2 id="CD copy protection">CD copy protection</h2><p>When I try running the game Wine prints the following error to standard error:</p><pre><code>013c:err:ntoskrnl:ZwLoadDriver failed to create driver L&quot;\\Registry\\Machine\\System\\CurrentControlSet\\Services\\SecDrv&quot;: c0000142
</code></pre><p>This seems to be a problem with the copy protection (DRM) used by the game. I
have not found any solution, other than either using a No-CD patch or buying a
DRM-free version. CivFantatics (see below) are hosting a No-CD patch extracted
from a gaming magazine release. Yes, you are installing a mystery binary, but
that's probably the least shady place to get it if you want to go that route.</p><p>The files were taken from the <a href="https://www.pcgames.de/Civilization-3-Spiel-20090/News/Probleme-mit-Civ-3-Vollversion-Hier-gibts-Abhilfe-401682/">website of PCGames</a>, so if you don't trust the
download from CivFantatics you can also download the original files. Here are
the SHA-256 checksums I got from the official download:</p><ul><li><p><code>Civilization3.exe</code> (v1.21f without expansion): <code>6e57a1ab94eb005e4ba688dd7a30cd19698a7f3fe3357ead901058be5ae67704</code></p></li><li><p><code>Civilization3.exe</code> (v1.29f with expansion): <code>98f07e9b4acd756c4eeef3eaf84afccdc17189ef933186b2001259247cd0a067</code></p></li><li><p><code>Civ3Conquests.exe</code> (v1.22): <code>fbb9ae4c6fa9ece58e065b6396b25d693630afefe0cc45b31fc66914d1b44990</code></p></li></ul><p>This is as trustworthy as it gets with proprietary software.</p><h2 id="Black terrain">Black terrain</h2><p>As of the time of writing this there a bug in the <code>libOSMesa</code> library that
renders all terrain on the map as a black surface. The good news is that we
don't need this library for the game, so we can trick the game into using a
fake library.</p><p>Create a directory and add an empty file named <code>libOSMesa.so.8</code> (or whatever
the real one is named on your system), then set the <code>LD_LIBRARY_PATH</code>
environment variable to the path of that directory. We can for example start
the game with this command:</p><pre><code>LD_LIBRARY_PATH=&quot;path/to/fake/lib/&quot; wine 'Civilization3.exe'
</code></pre><p>I use a small launcher shell script so I don't have to type all of this by
hand.</p><h2 id="Broken fullscreen mode">Broken fullscreen mode</h2><p>By default Civ3 only runs in fullscreen, but instead of running in a real
fullscreen mode on top of all other windows, it lowers the resolution of the
screen and runs in a window. Maybe this happens because I am using a tiling
window manager (<a href="https://github.com/baskerville/bspwm">bspwm</a>).</p><p>The solution is to not allow the window manager to control the windows. Open
<code>winecfg</code> and uncheck the box in the “Graphics” tab. We can do this globally for
all applications, but then the map editor will also be affected, which you
probably don't want.</p><p>To set this option only for the game go to the “Applications” tab, click “Add
application” and select the executable of the game. Then, while the game
executable is highlighted uncheck the box in the “Graphics” tab. Repeat the
same steps for the expansion executable as well.</p><p>This is all documented in the Wine wiki: <a href="https://wiki.winehq.org/Winecfg#Using_winecfg">Using
winecfg</a></p><h2 id="Infinite sound effects loop">Infinite sound effects loop</h2><p>The last issue is more of an annoyance than a real game breaking problem.
Sometimes the game will be stuck playing an audio effect in an endless loop. It
is the most annoying when it gets stuck replaying bird voices or the cheering
crowd whenever you upgrade your palace.</p><p>I am not aware of any real solution to the issue. What I do instead is create a
short silent WAV file using Audacity (or <a href="https://tenacityaudio.org/">Tenacity</a>, or <a href="https://github.com/Sneeds-Feed-and-Seed/sneedacity">Sneedacity</a>, or
whatever the currently popular fork is) and replace the offending sound files.
I have replaced <code>Sounds/LoveTheKing.wav</code> and everything under <code>Sounds/Ambience Sfx</code>. There may be more files, I don't know, but I found this acceptable.</p><h2 id="Multiplayer">Multiplayer</h2><p>I haven't tried it, so no idea how well it works. I know there is an open bug
related to multiplayer, see below for the link.</p><h2 id="Links and references">Links and references</h2><h3 id="Useful resources">Useful resources</h3><ul><li><p><a href="https://www.pcgamingwiki.com/wiki/Civilization_III">PC Gaming Wiki article on Civ3</a> contains generally useful technical
information</p></li><li><p><a href="https://appdb.winehq.org/objectManager.php?sClass=application&amp;iId=426">WineHQ AppDB entry for Civ3</a> contains user feedback about the game running
in Wine</p></li><li><p><a href="https://forums.civfanatics.com/resources/categories/civilization-iii-downloads.13/">CivFantatics downloads for Civ3</a> is hosting a number of useful files,
including official patches</p></li></ul><h3 id="Bug tickets">Bug tickets</h3><ul><li><p><a href="https://bugs.winehq.org/show_bug.cgi?id=41930">Black terrain bug on WineHQ</a></p></li><li><p><a href="https://gitlab.freedesktop.org/mesa/mesa/-/issues/5094">Black terrain bug on Mesa</a></p></li><li><p><a href="https://bugs.winehq.org/show_bug.cgi?id=51502">Sound effect bug</a></p></li><li><p><a href="https://bugs.winehq.org/show_bug.cgi?id=17726">Multiplayer bug</a></p></li></ul></article><nav class="blog-pager"><a href="/blog/2022/06/15/introducing-cl-cmark/" rel="previous" style="float: left"><span aria-hidden="true">←</span> Introducing cl-cmark</a><a href="/blog/2022/10/02/a-new-static-site-generator/" rel="next" style="float: right">A new static site generator <span aria-hidden="true">→</span></a></nav></main><nav class="blog-navigation" aria-label="Blog navigation"><aside><span>subscribe:</span> <a href="/blog/rss.xml" type="application/rss+xml">RSS</a></aside><nav><h1><a href="/blog/archive/">archive</a></h1><ul><li><a href="/blog/2023/">2023 (10)</a></li><li><a href="/blog/2022/">2022 (13)</a></li><li><a href="/blog/2021/">2021 (5)</a></li><li><a href="/blog/2020/">2020 (15)</a></li><li><a href="/blog/2019/">2019 (17)</a></li><li><a href="/blog/2018/">2018 (1)</a></li><li><a href="/blog/2017/">2017 (4)</a></li><li><a href="/blog/2016/">2016 (6)</a></li><li><a href="/blog/2015/">2015 (2)</a></li></ul></nav><nav><h1><a href="/blog/categories/">categories</a></h1><ul><li><a href="/blog/categories/misc/">misc (19)</a></li><li><a href="/blog/categories/open-source/">open-source (24)</a></li><li><a href="/blog/categories/organisation/">organisation (14)</a></li><li><a href="/blog/categories/vim/">vim (16)</a></li></ul></nav><nav><h1><a href="/blog/tags/">tags</a></h1><ul><li><a href="/blog/tags/lisp/">lisp (20)</a></li><li><a href="/blog/tags/vim/">vim (17)</a></li><li><a href="/blog/tags/rant/">rant (14)</a></li><li><a href="/blog/tags/html/">html (10)</a></li><li><a href="/blog/tags/unix/">unix (8)</a></li><li><a href="/blog/tags/linux/">linux (5)</a></li><li><a href="/blog/tags/web/">web (4)</a></li><li><a href="/blog/tags/msgpack/">msgpack (3)</a></li><li><a href="/blog/tags/lua/">lua (3)</a></li><li><a href="/blog/tags/games/">games (3)</a></li><li><a href="/blog/tags/guix/">guix (2)</a></li><li><a href="/blog/tags/network/">network (2)</a></li><li><a href="/blog/tags/markdown/">markdown (2)</a></li><li><a href="/blog/tags/cocoa/">cocoa (1)</a></li><li><a href="/blog/tags/info/">info (1)</a></li><li><a href="/blog/tags/awk/">awk (1)</a></li><li><a href="/blog/tags/elixir/">elixir (1)</a></li><li><a href="/blog/tags/neovim/">neovim (1)</a></li><li><a href="/blog/tags/wine/">wine (1)</a></li><li><a href="/blog/tags/git/">git (1)</a></li><li><a href="/blog/tags/terminal/">terminal (1)</a></li><li><a href="/blog/tags/unity3d/">unity3d (1)</a></li></ul></nav></nav></div></div><footer><div><div class="footer-self"><a href="/" title="HiPhish's Workshop"><img src="/img/footer/logo.png" title="HiPhish's Workshop" height="55"/></a><p><a href="http://creativecommons.org/licenses/by-sa/4.0/"><img class="copyright-image" src="/img/footer/cc.svg" alt="Creative Commons Attribution-ShareAlike 4.0 International License"/> </a>© 2015-2022, licensed under <a href="http://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA 4.0</a></p></div><div class="footer-social"><a href="https://github.com/HiPhish" title="GitHub" target="blank"><img src="/img/footer/github.png" alt="GitHub" height="55"/> </a><a href="https://gitlab.com/HiPhish" title="GitLab" target="blank"><img src="/img/footer/gitlab.png" alt="GitLab" height="55"/> </a></div></div></footer></body></html>
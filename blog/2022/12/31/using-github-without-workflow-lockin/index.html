<!DOCTYPE html>
<html lang="en"><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><title>HiPhish's Workshop</title><link rel="stylesheet" href="/css/main.css" type="text/css" media="all"/><link rel="stylesheet" href="/css/local-nav.css" type="text/css" media="all"/><link rel="stylesheet" href="/css/blog.css" type="text/css" media="all"/></head><body><header><nav id="main-navbar"><input type="checkbox" id="main-nav-hamburger" hidden="hidden"/><div><a href="/">HiPhish's Workshop</a><label for="main-nav-hamburger" hidden="hidden"></label></div><ul><li><a href="/grid-framework/">Grid Framework</a><ul><li><a href="/grid-framework/">Overview</a></li><li hidden="hidden"/><li><a href="/grid-framework/features/">Features</a></li><li><a href="/grid-framework/examples/">Examples</a></li><li><a href="/grid-framework/gallery/">Gallery</a></li><li><a href="/grid-framework/showcase/">Showcase</a></li><li><a href="/grid-framework/faq/">FAQ</a></li><li><a href=" /grid-framework/news/">News</a></li><li hidden="hidden"/><li><a href="http://forum.unity3d.com/threads/grid-framework-scripting-and-editor-plugins.144886/">Support</a></li><li hidden="hidden"/><li><a href="https://www.assetstore.unity3d.com/#/content/62498">Buy Now <span class="badge">35$</span></a></li></ul></li><li><a href="/#products">Open Source</a><ul><li><a href="https://gitlab.com/HiPhish/ntfs-clone">NTFS-Clone</a></li><li><a href="https://gitlab.com/HiPhish/IPS-Tools">IPS-Tools</a></li><li><a href="https://gitlab.com/HiPhish/roll">roll</a></li><li><a href="https://github.com/HiPhish/Newton-method">Newton's Method in C</a></li><li><a href="https://github.com/HiPhish/XeenTools">Xeen Tools</a></li><li><a href="https://github.com/HiPhish/Wolf3DExtract">Wolf3D Extract</a></li><li><a href="https://github.com/HiPhish/Game-Source-Documentation">Game Source Documentation</a></li></ul></li><li><a href="/vim/plugins/">Vim/Nvim plugins</a><ul><li><a href="https://gitlab.com/HiPhish/info.vim">Info.vim</a></li><li><a href="https://gitlab.com/HiPhish/repl.nvim">REPL.nvim</a></li><li><a href="https://gitlab.com/HiPhish/quicklisp.nvim">Quicklisp.nvim</a></li><li><a href="https://gitlab.com/HiPhish/jinja.vim">jinja.vim</a></li><li><a href="https://gitlab.com/HiPhish/neovim-guix-channel/">Guix channel</a></li></ul></li><li class="push-end"><a href="/blog/">Blog</a></li><li><a href="/about/">About</a></li></ul></nav></header><div><div class="blog"><nav class="breadcrumbs" aria-label="Breadcrumbs"><ol><li class=""><a href="../../../../">blog</a></li><li class=""><a href="../../../">2022</a></li><li class=""><a href="../../">12</a></li><li class="active">31</li><li class="active">using-github-without-workflow-lockin</li></ol></nav><main class="blogpost"><article><h1><a href="." title="permalink to Using GitHub without workflow lock-in" rel="bookmark">Using GitHub without workflow lock-in</a></h1><header class="blog-post-header"><p class="blog-post-published">published: <time datetime="2022-12-31">2022-12-31</time></p><p class="blog-post-modified">modified: <time datetime="2023-02-26">2023-02-26</time></p><p class="blog-post-category">categories: <a href="../../../../categories/organisation/">organisation</a></p><p class="blog-post-tags">tags: <a href="../../../../tags/rant/">rant</a>, <a href="../../../../tags/git/">git</a></p></header><p>Git is a decentralized version control system, meaning that there is no one
superior repository.  Every single copy of a Git repository is just as complete
as any other.  Of course we can pick one particular repository and declare it
to be the one source of truth, the “upstream” repository.  Usually this
upstream repository is then hosted on some server, and if we are interested in
openness and collaboration this server is part of a larger web service, called
a “forge”.  Out of these forges <a href="https://github.com/">GitHub</a> is perhaps the most popular one.
Unfortunately this means if we are interested in contributions we have to make
the GitHub repo our upstream and use its web services and web UI for our
workflow.  At least that is the common wisdom, but it does not have to be that
way.</p><p>Recently I had the pull request <a href="https://github.com/HiPhish/nvim-cmp-vlime/pull/2">#2</a> filed in a Neovim plugin repo of mine.  I
wanted to see if it was possible to perform all the collaboration steps without
touching the GitHub UI once and without pushing anything to the GitHub repo.
The good news is that it was 100% feasible and it is going to be my preferred
way of using GitHub from now on.</p><h2 id="The scenario">The scenario</h2><p>My Neovim plugin <a href="https://gitlab.com/HiPhish/nvim-cmp-vlime">nvim-cmp-vlime</a> is hosted on <a href="https://gitlab.com/HiPhish/nvim-cmp-vlime">GitLab</a>.  There I have GitLab
set up to mirror any commits to the <code>master</code> branch to the <a href="https://github.com/HiPhish/nvim-cmp-vlime">GitHub mirror</a>
repository.  A contributor found the project on GitHub and created a pull
request using the usual GitHub workflow: he forked the project, created a
feature branch, committed his changes, pushed the feature branch to his fork on
GitHub and created a pull request.</p><p>The upstream repository does not have to be on GitLab, any forge which can
automatically push to a mirror will do the trick.</p><h2 id="Communication via email">Communication via email</h2><p>Whenever a new pull request or issue is filed I get notified via email.  I can
then either log in to GitHub or reply directly to the email.  If I do the
latter GitHub will add the message as a comment to the PR.  There is some
server-side magic going on that maps the email address of the message to the
discussion thread, but I do not need to concern myself with that.</p><p>The only downside of using email to reply is that the text is pasted verbatim.
This means Markdown markup is not applied and manual line breaks from the email
show up in the discussion thread.  This makes my messages very ugly to read for
web UI users.  GitLab can render Markdown from emails just fine, so this is a
GitHub problem.</p><h2 id="Reviewing the code">Reviewing the code</h2><p>We first need to somehow check out the contributor's fork locally.  The easiest
way is to use the official <a href="https://cli.github.com/">GitHub CLI tool</a>.  We need to add the GitHub mirror
as a remote to the local repository if we have not yet done so.</p><pre><code>git remote add github git@github.com:HiPhish/nvim-cmp-vlime.git
</code></pre><p>This is only necessary once per repository and the name of the remote does not
matter.  Now we can check out the PR.</p><pre><code>gh pr checkout 2
</code></pre><p>Here <code>2</code> is the ID of the PR.  This will create a local branch with the code
of the PR.  From here on we can test the code, review the diff and add our own
commits.  In this cases I needed to apply a little correction, so I made the
changes and committed to the PR branch directly.  I also posted a comment to
the discussion thread via email.</p><p>Once I was satisfied with the result I merged the PR branch locally to the
<code>master</code> branch and pushed the changes to the <code>origin</code> remote on GitLab.</p><pre><code>git checkout master
git merge monkoose/master  # This is the name of the local PR branch
git push
</code></pre><p>From here on GitLab and GitHub will take care of the rest.  GitLab pushes the
new commits to GitHub, GitHub detects that the commit from the PR has been
merged, assigns credit to the contributor and closes the PR.</p><h2 id="Conclusion">Conclusion</h2><p>I can now use GitHub as one of potentially many contribution channels, all from
the command line.  If messages from email would render Markdown properly this
would be perfect.  Maybe I can comment better from the GitHub command line tool
instead, I will have to try that out.  Git was never meant to be tied to one
single web service, and I would like to get off GitLab as well and host my own
server, but for the time being this is good enough.</p><p>There is one things I have not tried yet: commenting on a patch.  In the GitHub
web UI you can comment directly on individual lines during code review.  I
wonder if the command line tool can do this. We will find out once someone
opens a new pull request.  Using the CLI tool is an acceptable compromise, even
though I would prefer email, as long as I can push commits to my own upstream
instead of the GitHub mirror.</p><h2 id="Update: Checking out the PR with Git tool only">Update: Checking out the PR with Git tool only</h2><p>It has been brought to my attention that using the <code>gh</code> CLI tool is not really
&quot;without lock-in&quot;.  If you really do not want to use anything from GitHub you
can add the forked repository as a remote and then checkout the feature branch.</p><pre><code>git remote add -f feature-fork git@github.com:someuser/somerepo.git
git checkout --track feature-fork/branch-name
</code></pre><p>From there on everything proceeds as usual.</p></article><nav class="blog-pager"><a href="/blog/2022/12/30/a-filesystem-abstraction-for-hssg/" rel="previous" style="float: left"><span aria-hidden="true">←</span> A file system abstraction for HSSG</a><a href="/blog/2023/02/26/how-i-switch-colours-in-alacritty/" rel="next" style="float: right">How I switch colours in Alacritty <span aria-hidden="true">→</span></a></nav></main><nav class="blog-navigation" aria-label="Blog navigation"><aside><span>subscribe:</span> <a href="/blog/rss.xml" type="application/rss+xml">RSS</a></aside><nav><h1><a href="/blog/archive/">archive</a></h1><ul><li><a href="/blog/2023/">2023 (9)</a></li><li><a href="/blog/2022/">2022 (13)</a></li><li><a href="/blog/2021/">2021 (5)</a></li><li><a href="/blog/2020/">2020 (15)</a></li><li><a href="/blog/2019/">2019 (17)</a></li><li><a href="/blog/2018/">2018 (1)</a></li><li><a href="/blog/2017/">2017 (4)</a></li><li><a href="/blog/2016/">2016 (6)</a></li><li><a href="/blog/2015/">2015 (2)</a></li></ul></nav><nav><h1><a href="/blog/categories/">categories</a></h1><ul><li><a href="/blog/categories/misc/">misc (19)</a></li><li><a href="/blog/categories/open-source/">open-source (24)</a></li><li><a href="/blog/categories/organisation/">organisation (14)</a></li><li><a href="/blog/categories/vim/">vim (15)</a></li></ul></nav><nav><h1><a href="/blog/tags/">tags</a></h1><ul><li><a href="/blog/tags/lisp/">lisp (20)</a></li><li><a href="/blog/tags/vim/">vim (16)</a></li><li><a href="/blog/tags/rant/">rant (14)</a></li><li><a href="/blog/tags/html/">html (10)</a></li><li><a href="/blog/tags/unix/">unix (8)</a></li><li><a href="/blog/tags/linux/">linux (5)</a></li><li><a href="/blog/tags/web/">web (4)</a></li><li><a href="/blog/tags/msgpack/">msgpack (3)</a></li><li><a href="/blog/tags/lua/">lua (3)</a></li><li><a href="/blog/tags/games/">games (3)</a></li><li><a href="/blog/tags/guix/">guix (2)</a></li><li><a href="/blog/tags/network/">network (2)</a></li><li><a href="/blog/tags/markdown/">markdown (2)</a></li><li><a href="/blog/tags/cocoa/">cocoa (1)</a></li><li><a href="/blog/tags/info/">info (1)</a></li><li><a href="/blog/tags/awk/">awk (1)</a></li><li><a href="/blog/tags/elixir/">elixir (1)</a></li><li><a href="/blog/tags/neovim/">neovim (1)</a></li><li><a href="/blog/tags/wine/">wine (1)</a></li><li><a href="/blog/tags/git/">git (1)</a></li><li><a href="/blog/tags/terminal/">terminal (1)</a></li><li><a href="/blog/tags/unity3d/">unity3d (1)</a></li></ul></nav></nav></div></div><footer><div><div class="footer-self"><a href="/" title="HiPhish's Workshop"><img src="/img/footer/logo.png" title="HiPhish's Workshop" height="55"/></a><p><a href="http://creativecommons.org/licenses/by-sa/4.0/"><img class="copyright-image" src="/img/footer/cc.svg" alt="Creative Commons Attribution-ShareAlike 4.0 International License"/> </a>© 2015-2022, licensed under <a href="http://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA 4.0</a></p></div><div class="footer-social"><a href="https://github.com/HiPhish" title="GitHub" target="blank"><img src="/img/footer/github.png" alt="GitHub" height="55"/> </a><a href="https://gitlab.com/HiPhish" title="GitLab" target="blank"><img src="/img/footer/gitlab.png" alt="GitLab" height="55"/> </a></div></div></footer></body></html>
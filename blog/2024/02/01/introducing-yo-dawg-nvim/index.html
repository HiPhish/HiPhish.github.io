<!DOCTYPE html>
<html lang="en"><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><title>HiPhish's Workshop</title><link rel="stylesheet" href="/css/main.css" type="text/css" media="all"/><link rel="stylesheet" href="/css/local-nav.css" type="text/css" media="all"/><link rel="stylesheet" href="/css/blog.css" type="text/css" media="all"/></head><body><header><nav id="main-navbar"><input type="checkbox" id="main-nav-hamburger" hidden="hidden"/><div><a href="/">HiPhish's Workshop</a><label for="main-nav-hamburger" hidden="hidden"></label></div><ul><li><a href="/grid-framework/">Grid Framework</a><ul><li><a href="/grid-framework/">Overview</a></li><li hidden="hidden"/><li><a href="/grid-framework/features/">Features</a></li><li><a href="/grid-framework/examples/">Examples</a></li><li><a href="/grid-framework/gallery/">Gallery</a></li><li><a href="/grid-framework/showcase/">Showcase</a></li><li><a href="/grid-framework/faq/">FAQ</a></li><li><a href=" /grid-framework/news/">News</a></li><li hidden="hidden"/><li><a href="http://forum.unity3d.com/threads/grid-framework-scripting-and-editor-plugins.144886/">Support</a></li><li hidden="hidden"/><li><a href="https://www.assetstore.unity3d.com/#/content/62498">Buy Now <span class="badge">35$</span></a></li></ul></li><li><a href="/#products">Open Source</a><ul><li><a href="https://gitlab.com/HiPhish/ntfs-clone">NTFS-Clone</a></li><li><a href="https://gitlab.com/HiPhish/IPS-Tools">IPS-Tools</a></li><li><a href="https://gitlab.com/HiPhish/roll">roll</a></li><li><a href="https://github.com/HiPhish/Newton-method">Newton's Method in C</a></li><li><a href="https://github.com/HiPhish/XeenTools">Xeen Tools</a></li><li><a href="https://github.com/HiPhish/Wolf3DExtract">Wolf3D Extract</a></li><li><a href="https://github.com/HiPhish/Game-Source-Documentation">Game Source Documentation</a></li></ul></li><li><a href="/vim/plugins/">Vim/Nvim plugins</a><ul><li><a href="https://gitlab.com/HiPhish/info.vim">Info.vim</a></li><li><a href="https://gitlab.com/HiPhish/repl.nvim">REPL.nvim</a></li><li><a href="https://gitlab.com/HiPhish/quicklisp.nvim">Quicklisp.nvim</a></li><li><a href="https://gitlab.com/HiPhish/jinja.vim">jinja.vim</a></li><li><a href="https://gitlab.com/HiPhish/neovim-guix-channel/">Guix channel</a></li></ul></li><li class="push-end"><a href="/blog/">Blog</a></li><li><a href="/about/">About</a></li></ul></nav></header><div><div class="blog"><nav class="breadcrumbs" aria-label="Breadcrumbs"><ol><li class=""><a href="../../../../">blog</a></li><li class=""><a href="../../../">2024</a></li><li class=""><a href="../../">02</a></li><li class="active">01</li><li class="active">introducing-yo-dawg-nvim</li></ol></nav><main class="blogpost"><article><h1><a href="." title="permalink to Introducing Yo-Dawg.nvim" rel="bookmark">Introducing Yo-Dawg.nvim</a></h1><header class="blog-post-header"><p class="blog-post-published">published: <time datetime="2024-02-01">2024-02-01</time></p><p class="blog-post-category">categories: <a href="../../../../categories/vim/">vim</a></p><p class="blog-post-tags">tags: <a href="../../../../tags/neovim/">neovim</a>, <a href="../../../../tags/lua/">lua</a></p></header><p>Yo dawg, I heard you like Neovim, so I put a Neovim inside your Neovim, so you
can edit while you edit!  Ahem... anyway, in my <a href="/blog/2024/01/29/testing-neovim-plugins-with-busted/">previous post</a> I proposed a
plugin which would make it easier to control an embedded Neovim from within
Neovim.  So I went ahead and wrote <a href="https://gitlab.com/HiPhish/yo-dawg.nvim">yo-dawg.nvim</a> (<a href="https://github.com/HiPhish/yo-dawg.nvim">GitHub mirror</a>), named
after the “Yo dawg” internet meme.</p><p>Why would you need a plugin like this?  Well, you really don't, Neovim provides
all the tools you need, but if you find yourself starting Neovim processes and
sending them messages over and over again the boilerplate code can add up very
quickly.  Let's take a look at an example from the manual.  Here is what a
minimal session looks like using the stock Neovim API:</p><pre><code>-- Start the process
local cmd = {'nvim', '--embed', '--headless'}
local nvim = vim.fn.jobstart(cmd, {rpc = true})

-- Call an API method
local value = vim.rpcrequest(nvim, 'nvim_eval', '1 + 2')

-- Gracefully terminate the process
vim.rpcnotify(nvim, 'nvim_cmd', {cmd = 'quitall', bang = true}, {})
vim.fn.jobwait(nvim)
</code></pre><p>Now let's see what it looks like with yo-dawg:</p><pre><code>local yd = require 'yo-dawg'

-- Start the process
local nvim = yd.start()

-- Call an API method
local value = nvim:eval('1 + 2')

-- Gracefully terminate the process
yd.stop(nvim)
</code></pre><p>Much simpler and less noisy.  We only need to spell out what really matters.
Sure, if you only need to spin up a process once in a blue moon it might not be
worth pulling in an extra plugin, but when writing tests you need to spin up a
new process for each individual test.</p><p>The plugin is purely a library, there is nothing to configure, no new commands,
no new mappings.  The <code>start</code> function returns a handle to a new Neovim
process, the <code>stop</code> function gracefull quits the process.  You can call any
API method as a method of the handle, the names are the same minus the <code>nvim_</code>
prefix.  And the best part is that we are forwards compatible: thanks to
metatable magic any new API method will be supported automatically.</p><p>I have gone ahead and added it as a test dependency to
<a href="https://gitlab.com/HiPhish/rainbow-delimiters.nvim">rainbow-delimiters.nvim</a> and it has really improved the readability of my
tests.  You could say I was eating my own “dawg food”. I will definitely be
using it in further tests for other plugins and I hope other people find it
useful as well.  Who knows, maybe you will find a different use for it other
than testing.</p></article><nav class="blog-pager"><a href="/blog/2024/01/29/testing-neovim-plugins-with-busted/" rel="previous" style="float: left"><span aria-hidden="true">←</span> Testing Neovim plugins with Busted</a><a href="/blog/2024/02/15/writing-a-ring-buffer-tdd-style/" rel="next" style="float: right">Writing a ring buffer TDD style <span aria-hidden="true">→</span></a></nav></main><nav class="blog-navigation" aria-label="Blog navigation"><aside><span>subscribe:</span> <a href="/blog/rss.xml" type="application/rss+xml">RSS</a></aside><nav><h1><a href="/blog/archive/">archive</a></h1><ul><li><a href="/blog/2024/">2024 (5)</a></li><li><a href="/blog/2023/">2023 (11)</a></li><li><a href="/blog/2022/">2022 (13)</a></li><li><a href="/blog/2021/">2021 (5)</a></li><li><a href="/blog/2020/">2020 (15)</a></li><li><a href="/blog/2019/">2019 (17)</a></li><li><a href="/blog/2018/">2018 (1)</a></li><li><a href="/blog/2017/">2017 (4)</a></li><li><a href="/blog/2016/">2016 (6)</a></li><li><a href="/blog/2015/">2015 (2)</a></li></ul></nav><nav><h1><a href="/blog/categories/">categories</a></h1><ul><li><a href="/blog/categories/misc/">misc (20)</a></li><li><a href="/blog/categories/open-source/">open-source (24)</a></li><li><a href="/blog/categories/organisation/">organisation (14)</a></li><li><a href="/blog/categories/vim/">vim (21)</a></li></ul></nav><nav><h1><a href="/blog/tags/">tags</a></h1><ul><li><a href="/blog/tags/vim/">vim (20)</a></li><li><a href="/blog/tags/lisp/">lisp (20)</a></li><li><a href="/blog/tags/rant/">rant (14)</a></li><li><a href="/blog/tags/html/">html (10)</a></li><li><a href="/blog/tags/unix/">unix (8)</a></li><li><a href="/blog/tags/lua/">lua (6)</a></li><li><a href="/blog/tags/linux/">linux (5)</a></li><li><a href="/blog/tags/web/">web (4)</a></li><li><a href="/blog/tags/msgpack/">msgpack (3)</a></li><li><a href="/blog/tags/neovim/">neovim (3)</a></li><li><a href="/blog/tags/games/">games (3)</a></li><li><a href="/blog/tags/guix/">guix (2)</a></li><li><a href="/blog/tags/network/">network (2)</a></li><li><a href="/blog/tags/markdown/">markdown (2)</a></li><li><a href="/blog/tags/cocoa/">cocoa (1)</a></li><li><a href="/blog/tags/info/">info (1)</a></li><li><a href="/blog/tags/awk/">awk (1)</a></li><li><a href="/blog/tags/elixir/">elixir (1)</a></li><li><a href="/blog/tags/wine/">wine (1)</a></li><li><a href="/blog/tags/git/">git (1)</a></li><li><a href="/blog/tags/terminal/">terminal (1)</a></li><li><a href="/blog/tags/unity3d/">unity3d (1)</a></li><li><a href="/blog/tags/python/">python (1)</a></li><li><a href="/blog/tags/testing/">testing (1)</a></li></ul></nav></nav></div></div><footer><div><div class="footer-self"><a href="/" title="HiPhish's Workshop"><img src="/img/footer/logo.png" title="HiPhish's Workshop" height="55"/></a><p><a href="http://creativecommons.org/licenses/by-sa/4.0/"><img class="copyright-image" src="/img/footer/cc.svg" alt="Creative Commons Attribution-ShareAlike 4.0 International License"/> </a>© 2015-2022, licensed under <a href="http://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA 4.0</a></p></div><div class="footer-social"><a href="https://github.com/HiPhish" title="GitHub" target="blank"><img src="/img/footer/github.png" alt="GitHub" height="55"/> </a><a href="https://gitlab.com/HiPhish" title="GitLab" target="blank"><img src="/img/footer/gitlab.png" alt="GitLab" height="55"/> </a></div></div></footer></body></html>